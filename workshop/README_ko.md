## GitHub Copilot와 함께하는 레거시 프로젝트 업그레이드

레거시(구형) 파이썬 애플리케이션을 최신 파이썬 버전으로 올리는 과정을 GitHub Copilot의 도움으로 진행합니다.

> [!NOTE]
> 이 저장소는 **GitHub Copilot**의 다양한 기능(예: **Copilot Chat**, **inline chat**) 소개를 목적으로 합니다. 아래 단계별 가이드는 수행해야 할 일반적 작업을 설명하며, Copilot Chat 또는 inline chat은 필요한 명령을 생성하는 데 도움을 줄 수 있습니다.
>
> 각 단계(적용 가능하면)에는 Copilot 제안을 올바른 명령과 비교하여 검증할 수 있는 `Cheatsheet`가 포함되어 있습니다.
>
> 💡 다양한 프롬프트로 실험하며 Copilot 제안의 정확성이 어떻게 달라지는지 확인해 보세요. 예를 들어 inline chat을 사용할 때는 응답을 다듬기 위해 추가 프롬프트를 사용해 전체 프롬프트를 다시 작성하지 않고도 결과를 개선할 수 있습니다.

## 워크숍 특징

이 워크숍에서는 Python 2.5를 사용하던 레거시 파이썬 애플리케이션을 다룹니다. 주요 특징은 다음과 같습니다:

1. 모든 종속성은 사전 설치되어 있지만 레거시 애플리케이션 자체는 구형 파이썬 버전을 사용합니다.
1. 애플리케이션은 Sqlite3과 구식 파이썬 문법을 사용하므로 이를 업데이트해야 합니다.
1. 레거시 애플리케이션은 기능 테스트에 사용할 수 있는 문서를 포함합니다.
1. 단위 테스트와 기능 테스트가 레거시 코드의 일부로 제공됩니다.


### 1. 에이전트를 사용해 프로젝트 살펴보기

`@workspace` 에이전트를 사용해 이 프로젝트가 어떻게 구성되어 있는지 설명하도록 요청하세요.

- GitHub Copilot Chat을 열고 프롬프트 앞에 `@workspace`를 붙이세요.
- 이 프로젝트가 어떻게 종속성을 설치하는지 같은 질문을 해보세요.

### 2. 레거시와 포팅 문제 파악하기

파이썬 애플리케이션의 테스트를 실행해 보세요. 사전 설치된 `pytest`를 사용해 출력을 확인하세요. 어떤 일이 발생합니까?

- `@workspace what are some problems that this code may have as I port it to modern Python?` 같은 질문을 해보세요.
- 가상환경을 만들어 종속성을 설치해 보세요.

> [!NOTE]
> 왜 실패할 수 있나요? 이 코드베이스는 `distribute`를 사용하는 레거시 파이썬이기 때문에 종속성 설치가 실패할 가능성이 큽니다. Copilot을 사용해 다른 종속성 설치 방법을 제안받으세요.


### 3. 코드를 `upgraded` 디렉터리로 복사하기

포팅하려면 모든 코드를 `upgraded` 디렉터리로 복사해야 합니다. 이 디렉터리에서 실제로 작업을 진행합니다.

- 기능 테스트를 사용해 집중할 _slice_(작업 단위)를 결정하세요.

> [!NOTE]
> LLM이 비즈니스 로직의 모든 구성요소를 자동으로 파악하지 못할 수 있으므로, 설명이 항상 정확하지 않을 수 있습니다.


### 4. 프로젝트 설치

가상환경을 만들고 프로젝트를 설치하세요. `python setup.py develop`을 실행하고 에러가 발생하면 원인을 파악하세요.

- GitHub Copilot Chat에 에러를 붙여넣고 무슨 일이 일어나는지 안내를 받으세요.
- `#file:setup.py`로 파일을 컨텍스트에 추가해 설명을 얻으세요.
- 제안에 따라 오류를 수정하고 설치를 완료하세요.


### 5. 테스트 실행

프로젝트에는 `pytest`가 설치되어 있습니다. 단위 테스트를 실행하고 발생하는 오류를 살펴보세요.

- 에러 출력물을 Copilot에 붙여넣고 `#terminalSelection`을 포함해 도움을 요청하세요(출력 선택을 잊지 마세요).
- Copilot의 응답을 검토하고 필요한 경우 추가 질문을 하세요.
- 이 단계에서는 코드를 수정하지 마세요.

> [!NOTE]
> 에러가 즉시 파이썬 버전이 오래되었다는 신호를 주지 않을 수 있습니다. 더 나은 이해를 위해 추가 질문을 하고 전략을 정하세요. 프로젝트가 오래된 파이썬에서 작성되었음을 힌트로 제공해도 좋습니다.


### 6. try/except 관련 오류 수정

기능 테스트로 포커스할 _slice_를 정한 뒤, try/except 관련 오류를 수정하세요.

- GitHub Copilot을 사용해 문제 해결을 도와달라고 하세요. 구형 파이썬 버전임을 명시하세요.
- 모든 try/except 오류를 수정하고 테스트를 반복 실행해 오류가 해결될 때까지 진행하세요.

> [!NOTE]
> 예외 처리 관련 오류 외에도 다른 오류가 있을 수 있습니다. 다음 단계로 넘어가기 전에 try/except 문제를 먼저 깔끔하게 해결하세요.


### 7. ConfigParser 문제 해결

다음으로 `ConfigParser` 관련 문제를 다룹니다. Copilot에게 해결 전략을 물어보세요.

- "This project was built using Python 2.5 and with Python 3.9 I get the following:" 와 같이 질문하고 테스트 출력물을 포함하세요.
- 수정 방법은 간단할 수 있습니다. 한 옵션을 선택해 바로 구현하고 검증하세요.
- 변경 후 테스트를 실행해 수정이 올바른지 확인하세요.

[!NOTE]
> 모든 테스트가 통과되어야 합니다. 통과하지 않는다면 Copilot에 테스트 출력을 제공해 도움을 받아 이전 단계들을 다시 점검하세요.


### 8. 테스트를 Pytest 스타일로 이관

Pytest는 가장 널리 쓰이는 파이썬 테스트 프레임워크입니다. 레거시 코드는 `unittest`를 사용하므로 Pytest 스타일로 테스트를 이관하세요.

- 어떤 테스트 파일이든 `@workspace` 에이전트를 사용해 Pytest로 이관하는 방법을 물어보세요.
- 가능한 경우 테스트 클래스를 함수 기반 테스트로 바꿔 한 개의 테스트를 작성해 보세요.
- 테스트를 작성한 뒤 Copilot에게 다음에 생성할 테스트를 제안받으세요.

> [!NOTE]
> Pytest는 `unittest` 기반 테스트를 실행할 수 있지만, 직접 Pytest 스타일로 옮기면 확장성과 유연성이 좋아집니다. 앞으로 테스트를 추가하거나 수정할 때도 도움이 됩니다.


### 9. 최신 패키징 사용

레거시 코드는 이전에 `distribute`를 사용했지만 이미 수정했을 수 있습니다. 여전히 `setup.py` 기반 패키징을 사용한다면 `pyproject.toml`로 전환하세요.

- `pyproject.toml` 파일 작성 방법을 Copilot에게 물어보세요(`@workspace` 에이전트 사용). `setup.py`를 열어 컨텍스트로 제공하면 도움이 됩니다.
- 새 `pyproject.toml` 파일을 만들고 Copilot 제안으로 채워보세요.
- `pyproject.toml`을 이용해 프로젝트를 설치하세요(예: `pip install .`로 설치).

> [!NOTE]
> 파이썬 패키징은 여전히 복잡한 주제입니다. `pyproject.toml`은 새로운 표준이지만 완전히 정착하지 않은 경우도 있습니다. Copilot의 제안을 검증하고 설치 테스트를 반드시 수행하세요.


### 10. GitHub Actions로 자동화

레거시 프로젝트에는 자동화가 없습니다. GitHub Actions를 사용해 테스트와 검증 자동화를 구축하세요. 목표는 모든 풀 리퀘스트에 대해 워크플로가 실행되어 테스트와 설치를 시도하는 것입니다.

- `@workspace` 에이전트를 사용해 GitHub Actions 워크플로 작성 방법을 물어보세요.
- 워크플로를 만들기 위한 파일 및 디렉터리를 생성하세요.
- 변경사항을 푸시해 GitHub Actions가 동작하는지 확인하세요.

> [!NOTE]
> 자동화 구축은 현대 소프트웨어 개발의 핵심이지만 모든 설정이 완벽히 동작하도록 만드는 데 시간이 걸릴 수 있습니다. 인내심을 가지고 진행하며, 오류가 발생하면 Copilot의 도움을 받아 문제를 해결하세요.

